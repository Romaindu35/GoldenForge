--- a/net/minecraft/network/play/ServerPlayNetHandler.java
+++ b/net/minecraft/network/play/ServerPlayNetHandler.java
@@ -1,5 +_,6 @@
 package net.minecraft.network.play;
 
+import com.destroystokyo.paper.PaperConfig;
 import com.google.common.collect.Lists;
 import com.google.common.primitives.Doubles;
 import com.google.common.primitives.Floats;
@@ -150,6 +_,7 @@
 import net.minecraft.world.server.ServerWorld;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
+import org.spigotmc.SpigotConfig;
 
 public class ServerPlayNetHandler implements IServerPlayNetHandler {
    private static final Logger field_147370_c = LogManager.getLogger();
@@ -211,7 +_,7 @@
       if (this.field_184344_B && !this.field_147369_b.func_70608_bn()) {
          if (++this.field_147365_f > 80) {
             field_147370_c.warn("{} was kicked for floating too long!", (Object)this.field_147369_b.func_200200_C_().getString());
-            this.func_194028_b(new TranslationTextComponent("multiplayer.disconnect.flying"));
+            this.func_194028_b(new TranslationTextComponent(PaperConfig.flyingKickPlayerMessage));
             return;
          }
       } else {
@@ -230,7 +_,7 @@
          if (this.field_184345_D && this.field_147369_b.func_184208_bv().func_184179_bs() == this.field_147369_b) {
             if (++this.field_184346_E > 80) {
                field_147370_c.warn("{} was kicked for floating a vehicle too long!", (Object)this.field_147369_b.func_200200_C_().getString());
-               this.func_194028_b(new TranslationTextComponent("multiplayer.disconnect.flying"));
+               this.func_194028_b(new TranslationTextComponent(PaperConfig.flyingKickVehicleMessage));
                return;
             }
          } else {
@@ -365,7 +_,19 @@
             double d8 = d5 - this.field_184358_u;
             double d9 = entity.func_213322_ci().func_189985_c();
             double d10 = d6 * d6 + d7 * d7 + d8 * d8;
-            if (d10 - d9 > 100.0D && !this.func_217264_d()) {
+
+            ++this.field_184347_F;
+            int i = this.field_184347_F - this.field_184348_G;
+
+            double speed;
+            if (field_147369_b.field_71075_bZ.field_75100_b) {
+               speed = field_147369_b.field_71075_bZ.func_75093_a() * 20f;
+            } else {
+               speed = field_147369_b.field_71075_bZ.func_75094_b() * 10f;
+            }
+            speed *= 2f; // TODO: Get the speed of the vehicle instead of the player
+
+            if (d10 - d9 > Math.max(100.0D, Math.pow((double) (org.spigotmc.SpigotConfig.movedTooQuicklyMultiplier * (float) i * speed), 2)) && !this.func_217264_d()) {
                field_147370_c.warn("{} (vehicle of {}) moved too quickly! {},{},{}", entity.func_200200_C_().getString(), this.field_147369_b.func_200200_C_().getString(), d6, d7, d8);
                this.field_147371_a.func_179290_a(new SMoveVehiclePacket(entity));
                return;
@@ -385,15 +_,17 @@
             d8 = d5 - entity.func_226281_cx_();
             d10 = d6 * d6 + d7 * d7 + d8 * d8;
             boolean flag1 = false;
-            if (d10 > 0.0625D) {
+            if (d10 > SpigotConfig.movedWronglyThreshold) {
                flag1 = true;
                field_147370_c.warn("{} (vehicle of {}) moved wrongly! {}", entity.func_200200_C_().getString(), this.field_147369_b.func_200200_C_().getString(), Math.sqrt(d10));
             }
 
             entity.func_70080_a(d3, d4, d5, f, f1);
+            this.field_147369_b.func_70080_a(d3, d4, d5, this.field_147369_b.field_70177_z, this.field_147369_b.field_70125_A); // Forge - Resync player position on vehicle moving
             boolean flag2 = serverworld.func_226665_a__(entity, entity.func_174813_aQ().func_186664_h(0.0625D));
             if (flag && (flag1 || !flag2)) {
                entity.func_70080_a(d0, d1, d2, f, f1);
+               this.field_147369_b.func_70080_a(d3, d4, d5, this.field_147369_b.field_70177_z, this.field_147369_b.field_70125_A); // Forge - Resync player position on vehicle moving
                this.field_147371_a.func_179290_a(new SMoveVehiclePacket(entity));
                return;
             }
@@ -410,7 +_,7 @@
    }
 
    private boolean func_241162_a_(Entity p_241162_1_) {
-      return p_241162_1_.field_70170_p.func_234853_a_(p_241162_1_.func_174813_aQ().func_186662_g(0.0625D).func_72321_a(0.0D, -0.55D, 0.0D)).allMatch(AbstractBlock.AbstractBlockState::func_196958_f);
+      return BlockPos.func_239581_a_(p_241162_1_.func_174813_aQ().func_186662_g(0.0625D).func_72321_a(0.0D, -0.55D, 0.0D)).allMatch(b -> p_241162_1_.field_70170_p.func_180495_p(b).isAir(p_241162_1_.field_70170_p, b));
    }
 
    public void func_184339_a(CConfirmTeleportPacket p_184339_1_) {
@@ -804,9 +_,16 @@
                         i = 1;
                      }
 
+                     double speed;
+                     if (field_147369_b.field_71075_bZ.field_75100_b) {
+                        speed = field_147369_b.field_71075_bZ.func_75093_a() * 20f;
+                     } else {
+                        speed = field_147369_b.field_71075_bZ.func_75094_b() * 10f;
+                     }
+
                      if (!this.field_147369_b.func_184850_K() && (!this.field_147369_b.func_71121_q().func_82736_K().func_223586_b(GameRules.field_223615_r) || !this.field_147369_b.func_184613_cA())) {
                         float f2 = this.field_147369_b.func_184613_cA() ? 300.0F : 100.0F;
-                        if (d11 - d10 > (double)(f2 * (float)i) && !this.func_217264_d()) {
+                        if (d11 - d10 > Math.max(f2, Math.pow((double) (org.spigotmc.SpigotConfig.movedTooQuicklyMultiplier * (float) i * speed), 2)) && !this.func_217264_d()) {
                            field_147370_c.warn("{} moved too quickly! {},{},{}", this.field_147369_b.func_200200_C_().getString(), d7, d8, d9);
                            this.func_147364_a(this.field_147369_b.func_226277_ct_(), this.field_147369_b.func_226278_cu_(), this.field_147369_b.func_226281_cx_(), this.field_147369_b.field_70177_z, this.field_147369_b.field_70125_A);
                            return;
@@ -832,7 +_,7 @@
                      d9 = d6 - this.field_147369_b.func_226281_cx_();
                      d11 = d7 * d7 + d8 * d8 + d9 * d9;
                      boolean flag1 = false;
-                     if (!this.field_147369_b.func_184850_K() && d11 > 0.0625D && !this.field_147369_b.func_70608_bn() && !this.field_147369_b.field_71134_c.func_73083_d() && this.field_147369_b.field_71134_c.func_73081_b() != GameType.SPECTATOR) {
+                     if (!this.field_147369_b.func_184850_K() && d11 > SpigotConfig.movedWronglyThreshold && !this.field_147369_b.func_70608_bn() && !this.field_147369_b.field_71134_c.func_73083_d() && this.field_147369_b.field_71134_c.func_73081_b() != GameType.SPECTATOR) {
                         flag1 = true;
                         field_147370_c.warn("{} moved wrongly!", (Object)this.field_147369_b.func_200200_C_().getString());
                      }
@@ -950,7 +_,9 @@
       Direction direction = blockraytraceresult.func_216354_b();
       this.field_147369_b.func_143004_u();
       if (blockpos.func_177956_o() < this.field_147367_d.func_71207_Z()) {
-         if (this.field_184362_y == null && this.field_147369_b.func_70092_e((double)blockpos.func_177958_n() + 0.5D, (double)blockpos.func_177956_o() + 0.5D, (double)blockpos.func_177952_p() + 0.5D) < 64.0D && serverworld.func_175660_a(this.field_147369_b, blockpos)) {
+         double dist = field_147369_b.func_110148_a(net.minecraftforge.common.ForgeMod.REACH_DISTANCE.get()).func_111126_e() + 3;
+         dist *= dist;
+         if (this.field_184362_y == null && this.field_147369_b.func_70092_e((double)blockpos.func_177958_n() + 0.5D, (double)blockpos.func_177956_o() + 0.5D, (double)blockpos.func_177952_p() + 0.5D) < dist && serverworld.func_175660_a(this.field_147369_b, blockpos)) {
             ActionResultType actionresulttype = this.field_147369_b.field_71134_c.func_219441_a(this.field_147369_b, serverworld, itemstack, hand, blockraytraceresult);
             if (direction == Direction.UP && !actionresulttype.func_226246_a_() && blockpos.func_177956_o() >= this.field_147367_d.func_71207_Z() - 1 && func_241166_a_(this.field_147369_b, itemstack)) {
                ITextComponent itextcomponent = (new TranslationTextComponent("build.tooHigh", this.field_147367_d.func_71207_Z())).func_240699_a_(TextFormatting.RED);
@@ -1097,7 +_,9 @@
          if (p_244548_1_.startsWith("/")) {
             this.func_147361_d(p_244548_1_);
          } else {
-            ITextComponent itextcomponent = new TranslationTextComponent("chat.type.text", this.field_147369_b.func_145748_c_(), p_244548_1_);
+            ITextComponent itextcomponent = new TranslationTextComponent("chat.type.text", this.field_147369_b.func_145748_c_(), net.minecraftforge.common.ForgeHooks.newChatWithLinks(p_244548_1_));
+            itextcomponent = net.minecraftforge.common.ForgeHooks.onServerChatEvent(this, p_244548_1_, itextcomponent);
+            if (itextcomponent == null) return;
             this.field_147367_d.func_184103_al().func_232641_a_(itextcomponent, ChatType.CHAT, this.field_147369_b.func_110124_au());
          }
 
@@ -1110,6 +_,8 @@
    }
 
    private void func_147361_d(String p_147361_1_) {
+      if ( SpigotConfig.logCommands )
+         this.field_147370_c.info(this.field_147369_b.func_200200_C_().getString() + " issued server command: " + p_147361_1_);
       this.field_147367_d.func_195571_aL().func_197059_a(this.field_147369_b.func_195051_bN(), p_147361_1_);
    }
 
@@ -1187,6 +_,7 @@
             if (p_147340_1_.func_149565_c() == CUseEntityPacket.Action.INTERACT) {
                optional = Optional.of(this.field_147369_b.func_190775_a(entity, hand));
             } else if (p_147340_1_.func_149565_c() == CUseEntityPacket.Action.INTERACT_AT) {
+               if (net.minecraftforge.common.ForgeHooks.onInteractEntityAt(field_147369_b, entity, p_147340_1_.func_179712_b(), hand) != null) return;
                optional = Optional.of(entity.func_184199_a(this.field_147369_b, p_147340_1_.func_179712_b(), hand));
             } else if (p_147340_1_.func_149565_c() == CUseEntityPacket.Action.ATTACK) {
                if (entity instanceof ItemEntity || entity instanceof ExperienceOrbEntity || entity instanceof AbstractArrowEntity || entity == this.field_147369_b) {
@@ -1402,6 +_,8 @@
    }
 
    public void func_147349_a(CCustomPayloadPacket p_147349_1_) {
+      PacketThreadUtil.func_218796_a(p_147349_1_, this, this.field_147369_b.func_71121_q());
+      net.minecraftforge.fml.network.NetworkHooks.onCustomPayload(p_147349_1_, this.field_147371_a);
    }
 
    public void func_217263_a(CSetDifficultyPacket p_217263_1_) {
